sudo: required
dist: trusty

language: cpp

os:
  - linux
  - osx

compiler:
  - clang
  - gcc

before_install:
  - if [ "${TRAVIS_OS_NAME}" == "linux" ]; then sudo add-apt-repository ppa:george-edison55/cmake-3.x -y; fi
  - if [ "${TRAVIS_OS_NAME}" == "osx" ]; then brew update; fi

install:
  - if [ "${TRAVIS_OS_NAME}" == "linux" ]; then sudo apt-get upgrade; fi
  - if [ "${TRAVIS_OS_NAME}" == "osx" ]; then brew upgrade cmake; fi

before_script:
  - export OMP_NUM_THREADS=2
  - echo $OMP_NUM_THREADS
  # Out-of-source build
  - cd ..
  - mkdir SuperElastix-build
  - cd SuperElastix-build

script:
  - cmake ../SuperElastix/SuperBuild
  - make

after_success:
  - cd SuperElastix-build
  - ctest
